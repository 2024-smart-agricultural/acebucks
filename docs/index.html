<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>농산물 가격 모니터링</title>
  <style>
    table {
      width: 100%;
      border-collapse: collapse;
    }
    table, th, td {
      border: 1px solid black;
    }
    th, td {
      padding: 8px;
      text-align: left;
    }
  </style>
</head>
<body>
  <h1>일별 농산물 가격</h1>
  <div id="daily-prices"></div>

  <h1>지역별 농산물 가격</h1>
  <div id="regional-prices"></div>

  <script>
    async function fetchAndDisplayPrices(filename, containerId, tableHeaders) {
      try {
        const response = await fetch(filename);
        const data = await response.json();
        const container = document.getElementById(containerId);

        // 테이블 생성
        let table = document.createElement('table');
        let thead = document.createElement('thead');
        let tbody = document.createElement('tbody');

        // 테이블 헤더 생성
        let headerRow = document.createElement('tr');
        tableHeaders.forEach(header => {
          let th = document.createElement('th');
          th.textContent = header;
          headerRow.appendChild(th);
        });
        thead.appendChild(headerRow);

        // 테이블 본문 생성 (데이터 채우기)
        data.forEach(item => {
          let row = document.createElement('tr');
          tableHeaders.forEach(header => {
            let td = document.createElement('td');
            td.textContent = item[header] ? item[header] : '-';
            row.appendChild(td);
          });
          tbody.appendChild(row);
        });

        table.appendChild(thead);
        table.appendChild(tbody);
        container.appendChild(table);

      } catch (error) {
        console.error("데이터를 가져오거나 표시하는 중 오류가 발생했습니다:", error);
      }
    }

    // 각 JSON 데이터에 맞는 테이블 헤더 설정
    const dailyTableHeaders = ['productName', 'date', 'wholesalePrice', 'retailPrice']; // 예시 헤더들
    const regionalTableHeaders = ['region', 'productName', 'wholesalePrice', 'retailPrice']; // 예시 헤더들

    // 파일 경로와 테이블 헤더를 사용해 데이터를 가져와 테이블로 표시
    fetchAndDisplayPrices('./daily_product_prices_latest.json', 'daily-prices', dailyTableHeaders);
    fetchAndDisplayPrices('./regional_product_prices_latest.json', 'regional-prices', regionalTableHeaders);
  </script>
</body>
</html>
